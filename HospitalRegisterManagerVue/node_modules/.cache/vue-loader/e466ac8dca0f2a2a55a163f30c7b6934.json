{"remainingRequest":"E:\\HospitalAppointmentRegistration\\HospitalManager1\\HospitalManager\\HospitalRegisterManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\HospitalAppointmentRegistration\\HospitalManager1\\HospitalManager\\HospitalRegisterManagerVue\\src\\views\\DealOrderAgain.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"E:\\HospitalAppointmentRegistration\\HospitalManager1\\HospitalManager\\HospitalRegisterManagerVue\\src\\views\\DealOrderAgain.vue","mtime":1705080002747},{"path":"E:\\HospitalAppointmentRegistration\\HospitalManager1\\HospitalManager\\HospitalRegisterManagerVue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1689001368000},{"path":"E:\\HospitalAppointmentRegistration\\HospitalManager1\\HospitalManager\\HospitalRegisterManagerVue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1689001370000},{"path":"E:\\HospitalAppointmentRegistration\\HospitalManager1\\HospitalManager\\HospitalRegisterManagerVue\\node_modules\\postcss-loader\\src\\index.js","mtime":1689001370000},{"path":"E:\\HospitalAppointmentRegistration\\HospitalManager1\\HospitalManager\\HospitalRegisterManagerVue\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1689001368000},{"path":"E:\\HospitalAppointmentRegistration\\HospitalManager1\\HospitalManager\\HospitalRegisterManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1689001368000},{"path":"E:\\HospitalAppointmentRegistration\\HospitalManager1\\HospitalManager\\HospitalRegisterManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1689001370000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgovLyDorqnmloflrZflsYXkuK0KLmRydWdSaWd0aCB7CiAgdGV4dC1hbGlnbjogY2VudGVyOwp9Ci5lbC10YWcgewogIG1hcmdpbjogOHB4Owp9Ci5yaWd0aFRhYmxlIHsKICBtYXJnaW4tdG9wOiA1NnB4OwogIG1hcmdpbi1sZWZ0OiA4cHg7Cn0KLmRydWdJbnB1dCB7CiAgbWFyZ2luLXRvcDogOHB4OwogIG1hcmdpbi1ib3R0b206IDhweDsKfQouZWwtcm93IHsKICBtYXJnaW46IDVweDsKfQoub3JkZXJJbnB1dCB7CiAgd2lkdGg6IDI0MHB4Owp9Ci5lbC1wYWdpbmF0aW9uIHsKICBtYXJnaW46IDhweDsKfQo="},{"version":3,"sources":["DealOrderAgain.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DealOrderAgain.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <el-card>\n      <el-row>\n        <el-col :span=\"7\">\n          挂号单号：<el-input\n            disabled\n            v-model=\"oId\"\n            class=\"orderInput\"\n          ></el-input>\n        </el-col>\n        <el-col :span=\"7\">\n          患者账号：<el-input\n            disabled\n            v-model=\"pId\"\n            class=\"orderInput\"\n          ></el-input\n        ></el-col>\n        <el-col :span=\"7\">\n          患者姓名：<el-input\n            disabled\n            v-model=\"pName\"\n            class=\"orderInput\"\n          ></el-input>\n        </el-col>\n        <el-col :span=\"3\">\n          <el-button\n            type=\"success\"\n            style=\"font-size: 18px;\"\n            icon=\"iconfont icon-r-paper\"\n            @click=\"submitClick\"\n          >\n            提交</el-button\n          >\n        </el-col>\n      </el-row>\n      <el-row>\n        <el-col :span=\"7\">\n          患者性别：<el-input\n            disabled\n            v-model=\"pGender\"\n            class=\"orderInput\"\n          ></el-input>\n        </el-col>\n        <el-col :span=\"7\">\n          联系方式：<el-input\n            disabled\n            v-model=\"pPhone\"\n            class=\"orderInput\"\n          ></el-input\n        ></el-col>\n        <el-col :span=\"7\">\n          医生姓名：<el-input\n            disabled\n            v-model=\"dName\"\n            class=\"orderInput\"\n          ></el-input>\n        </el-col>\n        <el-col :span=\"3\">\n          <el-button\n            type=\"success\"\n            style=\"font-size: 18px;\"\n            @click=\"openAdvice\"\n          >\n            <i class=\"iconfont icon-r-add\" style=\"font-size: 20px;\"></i>\n            诊断/意见</el-button\n          >\n        </el-col>\n      </el-row>\n      <!-- 药物表格 -->\n      <el-row>\n        <el-col :span=\"12\">\n          <el-input\n            v-model=\"queryDrug\"\n            placeholder=\"请输入名称查询\"\n            class=\"drugInput\"\n          >\n            <el-button\n              slot=\"append\"\n              icon=\"el-icon-search\"\n              @click=\"requestDrug\"\n            ></el-button>\n          </el-input>\n          <el-table :data=\"drugData\" stripe border>\n            <el-table-column label=\"编号\" prop=\"drId\"></el-table-column>\n            <el-table-column label=\"名称\" prop=\"drName\"></el-table-column>\n            <el-table-column label=\"剩余数量\" prop=\"drNumber\"></el-table-column>\n            <el-table-column label=\"单位\" prop=\"drUnit\"></el-table-column>\n            <el-table-column label=\"单价\" prop=\"drPrice\"></el-table-column>\n            <el-table-column label=\"操作\" width=\"120\" fixed=\"right\">\n              <template slot-scope=\"scope\">\n                <el-button\n                  type=\"success\"\n                  style=\"font-size: 14px;\"\n                  @click=\"addDrug(scope.row.drId)\"\n                >\n                  <i class=\"iconfont icon-r-add\" style=\"font-size: 16px;\"></i>\n                  增加</el-button\n                >\n              </template>\n            </el-table-column>\n          </el-table>\n          <!-- 分页 -->\n          <el-pagination\n            @size-change=\"handleSizeChange\"\n            @current-change=\"handleCurrentChange\"\n            background\n            layout=\"total, sizes, prev, pager, next\"\n            :total=\"total\"\n            :page-size=\"size\"\n            :page-sizes=\"[1, 2, 4, 8, 16]\"\n          >\n          </el-pagination>\n          <el-row></el-row>\n        </el-col>\n        <!-- 右边已选择的药物 -->\n        <el-col :span=\"12\" class=\"drugRigth\">\n          <el-table stripe border :data=\"drugBuyData\" class=\"rigthTable\">\n            <el-table-column label=\"编号\" prop=\"drId\"></el-table-column>\n            <el-table-column label=\"名称\" prop=\"drName\"></el-table-column>\n            <el-table-column label=\"单价\" prop=\"drPrice\"></el-table-column>\n            <el-table-column label=\"数量\" prop=\"drNum\"></el-table-column>\n            <el-table-column label=\"小记\" prop=\"drSum\"></el-table-column>\n            <el-table-column label=\"操作\" width=\"120\" fixed=\"right\">\n              <template slot-scope=\"scope\">\n                <el-button\n                  type=\"danger\"\n                  style=\"font-size: 14px;\"\n                  icon=\"iconfont icon-r-delete\"\n                  @click=\"deleteDrug(scope.row.drId)\"\n                >\n                  移除</el-button\n                >\n              </template>\n            </el-table-column>\n          </el-table>\n          <el-tag>共计：{{ drugTotalPrice }}元</el-tag>\n        </el-col>\n      </el-row>\n      <!-- 检查项目编写 -->\n      <el-row>\n        <el-col :span=\"12\">\n          <el-input\n            v-model=\"queryCheck\"\n            placeholder=\"请输入名称查询\"\n            class=\"drugInput\"\n          >\n            <el-button\n              slot=\"append\"\n              icon=\"el-icon-search\"\n              @click=\"requestCheck\"\n            ></el-button>\n          </el-input>\n          <el-table stripe border :data=\"checkData\">\n            <el-table-column label=\"编号\" prop=\"iId\"></el-table-column>\n            <el-table-column label=\"项目\" prop=\"iName\"></el-table-column>\n            <el-table-column label=\"价格\" prop=\"iPrice\"></el-table-column>\n            <el-table-column label=\"操作\" width=\"120\" fixed=\"right\">\n              <template slot-scope=\"scope\">\n                <el-button\n                  type=\"success\"\n                  style=\"font-size: 14px;\"\n                  @click=\"addCheck(scope.row.iId)\"\n                >\n                  <i class=\"iconfont icon-r-add\" style=\"font-size: 16px;\"></i>\n                  增加</el-button\n                >\n              </template>\n            </el-table-column>\n          </el-table>\n          <!-- 分页 -->\n          <el-pagination\n            @size-change=\"checkSizeChange\"\n            @current-change=\"checkCurrentChange\"\n            background\n            layout=\"total, prev, pager, next\"\n            :total=\"checkTotal\"\n            :page-size=\"checkSize\"\n          >\n          </el-pagination>\n        </el-col>\n        <!-- 右边已选择的检查 -->\n        <el-col :span=\"12\" class=\"drugRigth\">\n          <el-table stripe border class=\"rigthTable\" :data=\"checkBuyData\">\n            <el-table-column label=\"编号\" prop=\"iId\"></el-table-column>\n            <el-table-column label=\"项目\" prop=\"iName\"></el-table-column>\n            <el-table-column label=\"价格\" prop=\"iPrice\"></el-table-column>\n            <el-table-column label=\"操作\" width=\"120\" fixed=\"right\">\n              <template slot-scope=\"scope\">\n                <el-button\n                  type=\"danger\"\n                  style=\"font-size: 14px;\"\n                  icon=\"iconfont icon-r-delete\"\n                  @click=\"deleteCheck(scope.row.iId)\"\n                >\n                  移除</el-button\n                >\n              </template>\n            </el-table-column>\n          </el-table>\n          <el-tag>共计：{{ checkTotalPrice }}元</el-tag>\n        </el-col>\n      </el-row>\n      <!-- 材料 -->\n      <el-row>\n        <el-col :span=\"12\">\n          <el-input\n            v-model=\"queryMaterial\"\n            placeholder=\"请输入名称查询\"\n            class=\"drugInput\"\n          >\n            <el-button\n              slot=\"append\"\n              icon=\"el-icon-search\"\n              @click=\"requestMaterial\"\n            ></el-button>\n          </el-input>\n          <el-table :data=\"materialData\" stripe border>\n            <el-table-column label=\"编号\" prop=\"mId\"></el-table-column>\n            <el-table-column label=\"名称\" prop=\"mName\"></el-table-column>\n            <el-table-column label=\"剩余数量\" prop=\"mNumber\"></el-table-column>\n            <el-table-column label=\"单位\" prop=\"mUnit\"></el-table-column>\n            <el-table-column label=\"单价\" prop=\"mPrice\"></el-table-column>\n            <el-table-column label=\"操作\" width=\"140\" fixed=\"right\">\n              <template slot-scope=\"scope\">\n                <el-button\n                  type=\"success\"\n                  style=\"font-size: 14px;\"\n                  @click=\"addMaterial(scope.row.mId)\"\n                >\n                  <i class=\"iconfont icon-r-add\" style=\"font-size: 16px;\"></i>\n                  增加</el-button\n                >\n              </template>\n            </el-table-column>\n          </el-table>\n          <!-- 分页 -->\n          <el-pagination\n            @size-change=\"handleSizeChange\"\n            @current-change=\"handleCurrentChange\"\n            background\n            layout=\"total, sizes, prev, pager, next\"\n            :total=\"materialtotal\"\n            :page-size=\"materialsize\"\n            :page-sizes=\"[1, 2, 4, 8, 16]\"\n          >\n          </el-pagination>\n          <el-row></el-row>\n        </el-col>\n        <!-- 右边已选择的材料 -->\n        <el-col :span=\"12\" class=\"drugRigth\">\n          <el-table stripe border :data=\"materialBuyData\" class=\"rigthTable\">\n            <el-table-column label=\"编号\" prop=\"mId\"></el-table-column>\n            <el-table-column label=\"名称\" prop=\"mName\"></el-table-column>\n            <el-table-column label=\"单价\" prop=\"mPrice\"></el-table-column>\n            <el-table-column label=\"数量\" prop=\"mNum\"></el-table-column>\n            <el-table-column label=\"小记\" prop=\"mSum\"></el-table-column>\n            <el-table-column label=\"操作\" width=\"140\" fixed=\"right\">\n              <template slot-scope=\"scope\">\n                <el-button\n                  type=\"danger\"\n                  style=\"font-size: 14px;\"\n                  icon=\"iconfont icon-r-delete\"\n                  @click=\"deleteMaterial(scope.row.mId)\"\n                >\n                  移除</el-button\n                >\n              </template>\n            </el-table-column>\n          </el-table>\n          <el-tag>共计：{{ materialTotalPrice }}元</el-tag>\n        </el-col>\n      </el-row>\n    </el-card>\n\n    <!-- 病因编写对话框 -->\n    <el-dialog title=\"诊断及医生建议编写\" :visible.sync=\"adviceFormVisible\">\n      <el-input\n        type=\"textarea\"\n        :rows=\"8\"\n        placeholder=\"请输入内容\"\n        v-model=\"advice\"\n      >\n      </el-input>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"adviceFormVisible = false\" style=\"font-size: 18px;\">\n          取 消</el-button\n        >\n        <el-button type=\"primary\" @click=\"holdAdvice\">保存</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport jwtDecode from \"jwt-decode\";\nimport { getToken } from \"@/utils/storage.js\";\nimport request from \"@/utils/request.js\";\nexport default {\n  name: \"dealOrderAgain\",\n  data() {\n    return {\n      oId: 1,\n      pId: 1,\n      dId: 0,\n      pName: \"aa\",\n      pGender: \"as\",\n      pPhone: \"asd\",\n      dName: \"\",\n      drugData: [],\n      size: 4,\n      pageNumber: 1,\n      total: 3,\n      queryDrug: \"\",\n      drugBuyData: [],\n      drugTotalPrice: 0,\n      //病因\n      advice: \"\",\n      //项目表格数据\n      checkData: [],\n      queryCheck: \"\",\n      checkTotal: 3,\n      checkSize: 4,\n      checkPageNumber: 1,\n      checkTotalPrice: 0,\n      checkBuyData: [],\n      //材料表格数据\n      materialData: [],\n      queryMaterial: \"\",\n      materialTotal: 3,\n      materialSize: 4,\n      materialPageNumber: 1,\n      materialTotalPrice: 0,\n      materialBuyData: [],\n      // 病因编写对话框显示参数\n      adviceFormVisible: false,\n    };\n  },\n  methods: {\n    //根据id减少药物数量\n    reduceDrugNumber(drId, usedNumber) {\n      request\n        .get(\"drug/reduceDrugNumber\", {\n          params: {\n            drId: drId,\n            usedNumber: usedNumber,\n          },\n        })\n        .then((res) => {\n          if (res.data.status !== 200) {\n            this.$message.error(\"药物数量不足！！\");\n          }\n        });\n    },\n    //点击提交按钮\n    submitClick() {\n      for (let i = 0; i < this.drugBuyData.length; i++) {\n        this.reduceDrugNumber(\n          this.drugBuyData[i].drId,\n          this.drugBuyData[i].drNum\n        );\n      }\n      let data = {\n        oId: this.dataPackage().oId,\n        //   pId: this.pId,\n        //   dId: this.dId,\n        oAdvice: this.dataPackage().oAdvice,\n        oDrug: this.dataPackage().oDrug,\n        oItem: this.dataPackage().oItem,\n        oMaterial: this.dataPackage().oMaterial,\n        oTotalPrice: this.dataPackage().oTotalPrice,\n      };\n      request\n        .post(\"order/updateOrderByAdd\", data)\n        .then((res) => {\n          console.log(res);\n          if (res.data.status !== 200) {\n            this.$message.error(\"请求信息错误\");\n            return;\n          }\n          this.$message.success(\"提交成功！请登录系统自助缴费！\");\n          request\n            .get(\"order/findTotalPrice\", {\n              params: {\n                oId: data.oId,\n              },\n            })\n            .then((res) => {\n              if (res.data.status === 200)\n                this.$message.success(\"提交成功！请登录系统自助缴费！\");\n            });\n\n          this.$router.push(\"/orderToday\");\n          console.log(res.data);\n        })\n        .catch((err) => {\n          console.error(err);\n        });\n    },\n    //封装数据\n    dataPackage() {\n      let oDrug = \" // \";\n      let oItem = \" // \";\n      let oTotalPrice = 0;\n      let oId = this.oId;\n      let oMaterial=\" // \"\n      let oAdvice = this.advice;\n      for (let i = 0; i < this.drugBuyData.length; i++) {\n        oDrug +=\n          this.drugBuyData[i].drName +\n          \"*\" +\n          this.drugBuyData[i].drPrice +\n          \"(元)*\" +\n          this.drugBuyData[i].drNum +\n          \" \";\n      }\n      for (let i = 0; i < this.checkBuyData.length; i++) {\n        oItem +=\n          this.checkBuyData[i].iName +\n          \"*\" +\n          this.checkBuyData[i].iPrice +\n          \"(元) \";\n      }\n      for (let i = 0; i < this.materialBuyData.length; i++) {\n        oMaterial +=\n          this.materialBuyData[i].mName +\n          \"*\" +\n          this.materialBuyData[i].mPrice +\n          \"(元) \";\n      }\n      oItem += \" 项目总价\" + this.checkTotalPrice + \"元 \";\n      oDrug += \" 药物总价\" + this.drugTotalPrice + \"元 \";\n      oMaterial += \" 材料总价\" + this.materialTotalPrice + \"元 \";\n      oTotalPrice = this.checkTotalPrice + this.drugTotalPrice+this.materialTotalPrice;\n      return { oId, oAdvice, oDrug, oItem, oMaterial, oTotalPrice };\n    },\n    //点击病因保存按钮\n    holdAdvice() {\n      this.adviceFormVisible = false;\n      this.$message.success(\"信息保存成功！\");\n    },\n    //打开病因编写对话框\n    openAdvice() {\n      this.adviceFormVisible = true;\n    },\n    //检查列表点击移除按钮\n    deleteCheck(iId) {\n      for (let i = 0; i < this.checkBuyData.length; i++) {\n        if (this.checkBuyData[i].iId === iId) {\n          this.checkTotalPrice -= this.checkBuyData[i].iPrice; //药物价格总计\n          this.checkBuyData.splice(i, 1); //！！！！！！删除数组中下标为i的元素\n        }\n      }\n    },\n    //检查列表点击增加按钮\n    addCheck(iId) {\n      request\n        .get(\"check/findCheck\", {\n          params: {\n            iId: iId,\n          },\n        })\n        .then((res) => {\n          if (res.data.status != 200) this.$message.error(\"信息请求失败\");\n          //后端传过来的是对象，表格绑定的数组\n          this.checkBuyData.push({\n            iId: res.data.data.iId,\n            iPrice: res.data.data.iPrice,\n            iName: res.data.data.iName,\n          });\n          this.checkTotalPrice += res.data.data.iPrice; //药物价格总计\n          console.log(res.data.data);\n        });\n    },\n    //药物页面大小切换时触发\n    checkSizeChange(size) {\n      this.checkSize = size;\n      this.requestCheck();\n    },\n    //检查页数切换时触发\n    checkCurrentChange(num) {\n      this.checkPageNumber = num;\n      this.requestCheck();\n    },\n    //请求检查项目\n    requestCheck() {\n      request\n        .get(\"check/findAllChecks\", {\n          params: {\n            size: this.checkSize,\n            pageNumber: this.checkPageNumber,\n            query: this.queryCheck,\n          },\n        })\n        .then((res) => {\n          if (res.data.status != 200) this.$message.error(\"获取信息失败\");\n          this.checkData = res.data.data.checks;\n          this.checkTotal = res.data.data.total;\n          console.log(res);\n        });\n    },\n    //请求材料项目\n    requestMaterial() {\n      request\n        .get(\"material/findAllMaterials\", {\n          params: {\n            size: this.materialSize,\n            pageNumber: this.materialPageNumber,\n            query: this.queryMaterial,\n          },\n        })\n        .then((res) => {\n          if (res.data.status != 200) this.$message.error(\"获取信息失败\");\n          this.materialData = res.data.data.material;\n          this.materialTotal = res.data.data.total;\n          console.log(res);\n        });\n    },\n    //材料列表点击移除按钮\n    deleteMaterial(mId) {\n      for (let i = 0; i < this.materialBuyData.length; i++) {\n        if (this.materialBuyData[i].mId === mId) {\n          this.materialTotalPrice -= this.materialBuyData[i].mPrice; //材料价格总计\n          this.materialBuyData.splice(i, 1); //！！！！！！删除数组中下标为i的元素\n        }\n      }\n    },\n    //材料列表点击增加按钮\n    addMaterial(mId) {\n      request\n        .get(\"material/findMaterial\", {\n          params: {\n            mId: mId,\n          },\n        })\n        .then((res) => {\n          // if (res.data.status != 200)\n          //   return this.$message.error(\"信息请求失败\");\n          // //后端传过来的是对象，表格绑定的数组\n          // this.materialBuyData.push({\n          //   mId: res.data.data.mId,\n          //   mPrice: res.data.data.mPrice,\n          //   mName: res.data.data.mName,\n          // });\n          // this.materialTotalPrice += res.data.data.mPrice; //药物价格总计\n          // console.log(res.data.data);\n          if (res.data.status != 200) this.$message.error(\"信息请求失败\");\n          //后端传过来的是对象，表格绑定的数组\n          for (let i = 0; i < this.materialBuyData.length; i++) {\n            if (this.materialBuyData[i].mId === res.data.data.mId) {\n              for (let j = 0; j < this.materialData.length; j++) {\n                if (\n                  this.materialData[j].mId === res.data.data.mId &&\n                  this.materialData[j].mNumber > 0\n                ) {\n                  this.materialData[j].mNumber -= 1;\n                  this.materialBuyData[i].mNum += 100;\n                  this.materialBuyData[i].mSum =\n                    this.materialBuyData[i].mPrice * this.materialBuyData[i].mNum;\n                  this.materialTotalPrice += this.materialBuyData[i].mPrice; //药物价格总计\n                  //return;\n                }\n              }\n              return;\n            }\n          }\n          for (let j = 0; j < this.materialData.length; j++) {\n            if (\n              this.materialData[j].mId === res.data.data.mId &&\n              this.materialData[j].mNumber <= 0\n            )\n              return;\n          }\n          this.materialBuyData.push({\n            mId: res.data.data.mId,\n            mPrice: res.data.data.mPrice,\n            mName: res.data.data.mName,\n            mNum: 100,\n            mSum: res.data.data.mPrice,\n          });\n          for (let j = 0; j < this.materialData.length; j++) {\n            if (this.materialData[j].mId === res.data.data.mId)\n              this.materialData[j].mNumber -= 1;\n          }\n          this.materialTotalPrice += res.data.data.mPrice; //药物价格总计\n\n          console.log(res.data.data);\n        });\n    },\n    //材料页面大小切换时触发\n    materialSizeChange(size) {\n      this.materialSize = size;\n      this.requestMaterial();\n    },\n    //材料页数切换时触发\n    materialCurrentChange(num) {\n      this.materialPageNumber = num;\n      this.requestMaterial();\n    },\n    //药物列表点击移除按钮\n    deleteDrug(drId) {\n      for (let i = 0; i < this.drugBuyData.length; i++) {\n        if (this.drugBuyData[i].drId === drId) {\n          for (let j = 0; j < this.drugData.length; j++) {\n            if (this.drugData[j].drId === drId) this.drugData[j].drNumber += 1;\n          }\n          this.drugBuyData[i].drNum -= 1;\n          this.drugBuyData[i].drSum =\n            this.drugBuyData[i].drPrice * this.drugBuyData[i].drNum;\n          this.drugTotalPrice -= this.drugBuyData[i].drPrice; //药物价格总计\n          if (this.drugBuyData[i].drNum === 0) this.drugBuyData.splice(i, 1); //！！！！！！删除数组中下标为i的元素\n        }\n      }\n    },\n    //药物列表点击增加按钮\n    addDrug(drId) {\n      request\n        .get(\"drug/findDrug\", {\n          params: {\n            drId: drId,\n          },\n        })\n        .then((res) => {\n          if (res.data.status != 200) this.$message.error(\"信息请求失败\");\n          //后端传过来的是对象，表格绑定的数组\n          for (let i = 0; i < this.drugBuyData.length; i++) {\n            if (this.drugBuyData[i].drId === res.data.data.drId) {\n              for (let j = 0; j < this.drugData.length; j++) {\n                if (\n                  this.drugData[j].drId === res.data.data.drId &&\n                  this.drugData[j].drNumber > 0\n                ) {\n                  this.drugData[j].drNumber -= 1;\n                  this.drugBuyData[i].drNum += 1;\n                  this.drugBuyData[i].drSum =\n                    this.drugBuyData[i].drPrice * this.drugBuyData[i].drNum;\n                  this.drugTotalPrice += this.drugBuyData[i].drPrice; //药物价格总计\n                  //return;\n                }\n              }\n              return;\n            }\n          }\n          for (let j = 0; j < this.drugData.length; j++) {\n            if (\n              this.drugData[j].drId === res.data.data.drId &&\n              this.drugData[j].drNumber <= 0\n            )\n              return;\n          }\n          this.drugBuyData.push({\n            drId: res.data.data.drId,\n            drPrice: res.data.data.drPrice,\n            drName: res.data.data.drName,\n            drNum: 1,\n            drSum: res.data.data.drPrice,\n          });\n          for (let j = 0; j < this.drugData.length; j++) {\n            if (this.drugData[j].drId === res.data.data.drId)\n              this.drugData[j].drNumber -= 1;\n          }\n          this.drugTotalPrice += res.data.data.drPrice; //药物价格总计\n\n          console.log(res.data.data);\n        });\n    },\n    //药物页面大小切换时触发\n    handleSizeChange(size) {\n      this.size = size;\n      this.requestDrug();\n    },\n    //药物页数切换时触发\n    handleCurrentChange(num) {\n      this.pageNumber = num;\n      this.requestDrug();\n    },\n\n    //获取药物列表\n    requestDrug() {\n      request\n        .get(\"drug/findAllDrugs\", {\n          params: {\n            size: this.size,\n            pageNumber: this.pageNumber,\n            query: this.queryDrug,\n          },\n        })\n        .then((res) => {\n          if (res.data.status != 200) this.$message.error(\"获取信息失败\");\n          this.drugData = res.data.data.drugs;\n          this.total = res.data.data.total;\n\n          console.log(res);\n        });\n    },\n    //获取患者信息\n    requestPatient() {\n      request\n        .get(\"doctor/findPatientById\", {\n          params: {\n            pId: this.pId,\n          },\n        })\n        .then((res) => {\n          console.log(res);\n          if (res.data.status != 200) this.$message.error(\"获取信息失败\");\n          this.pName = res.data.data.pName;\n          this.pGender = res.data.data.pGender;\n          this.pPhone = res.data.data.pPhone;\n        });\n    },\n    //token解码\n    tokenDecode(token) {\n      if (token !== null) return jwtDecode(token);\n    },\n  },\n  created() {\n    this.dName = this.tokenDecode(getToken()).dName;\n    this.dId = this.tokenDecode(getToken()).dId;\n    this.oId = this.$route.query.oId;\n    this.pId = this.$route.query.pId;\n    this.requestPatient();\n    this.requestDrug();\n    this.requestCheck();\n    this.requestMaterial();\n  },\n};\n</script>\n<style lang=\"scss\">\n// 让文字居中\n.drugRigth {\n  text-align: center;\n}\n.el-tag {\n  margin: 8px;\n}\n.rigthTable {\n  margin-top: 56px;\n  margin-left: 8px;\n}\n.drugInput {\n  margin-top: 8px;\n  margin-bottom: 8px;\n}\n.el-row {\n  margin: 5px;\n}\n.orderInput {\n  width: 240px;\n}\n.el-pagination {\n  margin: 8px;\n}\n</style>\n"]}]}